# OLAP - OnLine Analytical Proccessing
- Аналитическая обработка данных в реальном времени
    - Многомерные БД
    - Proccessing: обрабатываются некие исходные данные
    - Analytical: чтобы получить какие-то аналитические отчёты или новые знания
    - OnLine: в реальном времени, практически без задержек на обработку

## Тех смысл  OLAP
- используется для построения отчётов на основе больших объёмов накопленных
    исторических данных за огромные промежутки времени, но эти отчёты обновляются
    не слишком часто(*в реальности всё кастомно)
- чаще всего это столбцовые СУБД типа clickhouse (или 
    поддерживающие column-orentation, greenplum не из коробки)
- данные выбираются быстро (быстрое чтение, а если zookeeper)
- в центре находится таблица фактов, в которой нахоодится 
    все показатели (сумма, кол-во) и ссылки на справочники
- чем больше столбцов, тем ниже скорость на запись и апдэйт
- больше про ДЕНОРМАЛИЗАЦИЮ

## Как работает?
- источники (дата сурсы) записываем в наше хранилище данных 
    затем информация поступает в olap кубы и дальше
    есть пользователи, которые обращаются к виринному слою данных,
    чтобы получать информацию из хранилища, но в обговоренном для них виде

### Операции с OLAP системами
- Roll-up - обобщение данных по измерениям
- Drill-down - углубление во временном периоде
- Slice - выбор определённого уровня отображения
- Dice - выбор данных из нескольких измерений
- Pivot - поворот осей данных куба

### olap cube
- многомерные системы(массивы)
    - например трёхмерный:
        - ребро: 
            страны: сша, канада, австрия
            время: март, апрель, май
            позиции: напитки, продукты питания, прочие товары
## слои 
* между слоями могут появляться доп слои для кастомной логики
* Stage: загружаем сырые данные для дальнейшей обработки
* ODS: хранение сырых данных, только тех, которые нужны
* DDS или DVH: содержит валидные данные, собранные по определённым правилам
* DataMart: данные для "бизнес"-пользователей
- Таблица фактов - что-то объединённое по всем таблицам
    - быстра на чтение и кастомный анализ за счёт доступа ко многим из одной
        но при вставке придётся соблюсти большее число правил
## Виды OLAP систем
### ROLAP
- Relational OLAP (построенный на отношениях таблиц и баз данных между собой)
    - система, которая напрямую ничего не хранит, но умеет быстро вынимать 
    всё необходимое
    - данные разложены по однотипным СУБД(PostgreSQL)
    - достаточно редко встречается (либо часто, но в маленьких компаниях)
### MOLAP 
- Multimensional OLAP ()
    - данные лежат не только в однотипных корпоративных базах данных
        (надо всё собирать и складывать вместе)
    - предварительная подготовка данных
    - позволяет структурировать данные под разные запросы пользователей 
### Гибрид первых двух

## Многомерные БД для OLAP
- GreenPlum db
- ClickHouse
- Vertica
- hadoop (*может исполнять роль вычислительного ядра)

* greenplum не хорошо ведёт себя при индексировании данных

# OLTP  OnLine Transaction Proccessing 
- обработка транзакций в реальном времени. Реляционные БД
    - очень часто oltp система работает в основе приложений, 
        передачи сообщений в мессенджерах или банках (*?именно транзакции)
- одновременное выполнение нескольких транзакций (экономических, финансовых,
    цифрового взаимодействия), таких как интернет-банкинг, покупки, ввод заказов
    или  отправка текстовых сообщений
- Задача - Ввод, редактирование, удаление данных в режиме онлайн и их хранение
- Больше про нормализацию

## Особенности
* Пример мессенджеры: большое кол-во активных юзеров, постоянный CRUD над сообщениями
- Нормализованные данные
- Высокая интенсивность добавления и изменения данных
- Большое количество одновременно активных пользователей
- Внесение данных и расчет осуществляют пользователи системы
- Содержат актуальные данные
- OLTP использует транзакции, которые включают небольшие объёмы данных
- Индексированные данные в базе данных могут быть легко доступны
- Трехуровневая архитектура, которая обычно состоит из уровня представления,
    уровня бизнес-логики и уровня хранилища данных

## Требования к OLTP системам
* Соответствие ACID
    - Атомарность: гарантия, что все шаги в транзакциях будут успешно завершены
    - Согласованность: транзакция поддерживает внутреннюю согласованность с БД
    - Изолированность: транзакция выполняется, как если бы она выполнялась одна
    - Устойчивость: результаты транзакции не будут потеряны в случае сбоя
* Параллельность
* Масштабируемость
* Доступность
* Высокая пропускная способность и короткое время реагирования
* Надежность
* Безопасность
* Восстанавливаемость
- Основные реляционные БД для OLTP
    - PostgreSQL
    - Oracle
    - MMSQL

# OLAP vs OLTP
* OLAP: оптимизирована для проведения комплексного анализа данных 
    с целью принятия более разумных решений
    - Поддерживает бизнес-аналитику (BI), интеллектуальный анализ данных
        и другие приложения поддержки принятия решений 
* OLTP оптимизирована для обработки огромного кличества транзакций

## Фокус
- системы OLAP позволяют извлекать данные для сложного анализа
- системы OLTP, напротив, идельно подходят для выполнения простых

## Источники данных
* База данных OLAP может поддерживать сложные запросы множества фактов данных
    из текущих и исторических. Различные БД OLTP могут быть источником информации.
* OLTP, наоборот, используют традиционную СУБД для размещения большого объёма транзакций
    в режиме реального времени

## Время обработки
* В OLAP время отклика существенно ниже, чем в OLTP. Рабочие нагрузки 
    требуют интенсивного чтения и включают огромные наборы данных
* Для транзакций и ответов в OLTP важна каждая мсек. Рабочие нагрузки включают
    простые операции чтения, записи через SQL, требуя меньше времени и места на хранение.

## Доступность
* OLAP, поскольку не изменяет текущие данные, резервное копирование систем можно выполнять реже
* OLTP-системы часто изменяют данные. Требуют частого или параллельного 
    резервного копирования для поддержания целостности данных

- Кликхаус быстрее гринплама